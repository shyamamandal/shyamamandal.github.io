from ase.units import kJ
from ase.eos import EquationOfState
import matplotlib.pyplot as plt
import numpy as np

# Define volumes and energies for different configurations
bcc_volumes = [658.5, 580.09, 567.66, 665.34, 543.34, 611.96, 519.72, 525.56, 592.7, 573.86, 631.63, 672.22, 644.97, 555.41, 561.52, 638.28, 618.47, 605.5, 508.17, 651.71, 513.92, 693.15, 686.13, 625.03, 549.35, 679.15, 700.23, 586.38, 537.37, 531.44, 599.08]
bcc_energies = [-266.58607291, -274.88304385, -275.01650344, -265.42486531, -273.91841821, -272.84083782, -270.75710013, -271.75851459, -274.34396609, -275.00192815, -270.59198815, -264.20529239, -268.72266835, -274.70638652, -274.91943881, -269.6920861, -272.16982586, -273.42926955, -268.30027033, -267.68621744, -269.60752557, -260.22185224, -261.60121574, -271.41893693, -274.37392046, -262.92988258, -258.79403941, -274.66230893, -273.33549926, -272.61784545, -273.93150318]

fcc_volumes = [1270.24, 1356.57, 1435.25, 1167.58, 1070.6, 1033.36, 1051.87, 1099.1, 1089.55, 1291.47, 1345.57, 1334.63, 1259.71, 1249.24, 1042.59, 1401.17, 1378.75, 1207.95, 1412.47, 1128.11, 1312.93, 1228.48, 1137.89, 1177.58, 1118.39, 1157.62, 1367.63, 1147.73, 1280.82, 1108.72, 1187.65, 1218.19, 1389.93, 1061.21, 1080.05, 1197.77, 1323.75, 1024.19, 1302.17, 1423.83, 1238.83]
fcc_energies = [-567.55335379, -551.14431909, -533.36721444, -580.0605289, -580.36536071, -576.09415426, -578.5834892, -581.80222481, -581.48129371, -563.91121572, -553.44620618, -555.68587409, -569.24653749, -570.85018913, -577.4298722, -541.32217978, -546.35049531, -576.30616047, -538.72240342, -581.8748844, -559.94817794, -573.77684531, -581.61744017, -579.29385033, -581.99416493, -580.70612501, -548.77796224, -581.22637503, -565.77403093, -581.97172389, -578.40990679, -575.0929189, -543.86550529, -579.56002771, -581.00391727, -577.4128431, -557.8529577, -574.57024874, -561.96829709, -536.0683134, -572.36139767]

hcp_volumes = [483.9, 511.34, 520.71, 502.08, 530.2, 569.3, 497.49, 525.44, 549.52, 574.31, 506.7, 544.64, 554.42, 534.98, 488.4, 564.31, 492.93, 559.35, 539.8, 516.01, 579.36]
hcp_energies = [-285.02628321, -291.68864547, -293.07078695, -289.90438308, -294.07394315, -294.73682677, -288.85437307, -293.61850193, -295.03054137, -294.48554261, -290.84809674, -294.91469677, -295.06807053, -294.44032525, -286.4189351, -294.91917887, -287.69350311, -295.03043642, -294.71852098, -292.42853425, -294.16836612]

def process_eos(volumes, energies, filename):
    eos = EquationOfState(volumes, energies, eos='birchmurnaghan')
    v0, e0, B = eos.fit()
    eos.plot(show=False)
    plt.savefig(f'{filename}.png')
    plt.close()
    cube_root_v0 = (v0 ** (1/3))/3
    return v0, e0, cube_root_v0

bcc_v0, bcc_e0, bcc_cube_root_v0 = process_eos(bcc_volumes, bcc_energies, 'fe_bcc_eos_plot')
fcc_v0, fcc_e0, fcc_cube_root_v0 = process_eos(fcc_volumes, fcc_energies, 'fe_fcc_eos_plot')
hcp_v0, hcp_e0, hcp_cube_root_v0 = process_eos(hcp_volumes, hcp_energies, 'fe_hcp_eos_plot')

print('BCC Cube Root Volume:', bcc_cube_root_v0)
print('FCC Cube Root Volume:', fcc_cube_root_v0)
print('HCP Cube Root Volume:', hcp_cube_root_v0)
