from ase.units import kJ
from ase.eos import EquationOfState
import matplotlib.pyplot as plt
import numpy as np

# Define volumes and energies for different configurations
bcc_volumes = [658.5, 766.06, 580.09, 707.35, 743.68, 665.34, 721.73, 611.96, 592.7, 573.86, 631.63, 672.22, 644.97, 751.09, 638.28, 736.31, 618.47, 773.62, 729.0, 605.5, 651.71, 714.52, 693.15, 686.13, 625.03, 781.23, 679.15, 758.55, 700.23, 586.38, 599.08]
bcc_energies = [-384.73380929, -367.45621546, -384.51220787, -378.56274309, -372.05069917, -384.09414996, -376.14459624, -386.53512689, -385.68869198, -383.72828079, -386.36794606, -383.3688149, -385.74211748, -370.57216121, -386.10404468, -373.47394961, -386.58747802, -365.82363807, -374.8393913, -386.3699347, -385.28453848, -377.38677238, -380.70889046, -381.67256096, -386.53061579, -364.14389239, -382.55949342, -369.03984617, -379.67142992, -385.16358589, -386.08887488]

fcc_volumes = [1270.24, 1167.58, 1291.47, 1345.57, 1334.63, 1259.71, 1249.24, 1207.95, 1312.93, 1228.48, 1137.89, 1177.58, 1157.62, 1147.73, 1280.82, 1187.65, 1218.19, 1197.77, 1323.75, 1302.17, 1238.83]
fcc_energies = [-731.71149551, -724.34851782, -731.50343972, -728.89741283, -729.63660494, -731.62002457, -731.39662538, -729.10366902, -730.80455008, -730.53840328, -718.99581961, -725.7832064, -722.74186971, -720.95716551, -731.67052879, -727.05156767, -729.89630574, -728.15778556, -730.27576967, -731.21407486, -731.03749387]

hcp_volumes = [569.2, 601.48, 612.51, 590.59, 623.67, 669.66, 585.19, 618.07, 646.39, 675.56, 596.02, 640.66, 652.15, 629.3, 574.5, 663.79, 579.83, 657.95, 634.96, 606.98, 681.5]
hcp_energies = [-358.28720795, -363.32249476, -364.25146623, -362.03403684, -364.84200781, -364.15899458, -361.2445217, -364.58872833, -365.06859319, -363.76925602, -362.722495, -365.12166303, -364.94156763, -365.01390368, -359.37285177, -364.48754262, -360.35733765, -364.74651052, -365.10273097, -363.83012605, -363.31498629]

def process_eos(volumes, energies, filename):
    eos = EquationOfState(volumes, energies, eos='birchmurnaghan')
    v0, e0, B = eos.fit()
    eos.plot(show=False)
    plt.savefig(f'{filename}.png')
    plt.close()
    cube_root_v0 = (v0 ** (1/3))/3
    return v0, e0, cube_root_v0

bcc_v0, bcc_e0, bcc_cube_root_v0 = process_eos(bcc_volumes, bcc_energies, 'cr_bcc_eos_plot')
fcc_v0, fcc_e0, fcc_cube_root_v0 = process_eos(fcc_volumes, fcc_energies, 'cr_fcc_eos_plot')
hcp_v0, hcp_e0, hcp_cube_root_v0 = process_eos(hcp_volumes, hcp_energies, 'cr_hcp_eos_plot')

print('BCC Cube Root Volume:', bcc_cube_root_v0)
print('FCC Cube Root Volume:', fcc_cube_root_v0)
print('HCP Cube Root Volume:', hcp_cube_root_v0)
